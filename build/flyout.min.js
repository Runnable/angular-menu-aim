"use strict";angular.module("neilff.flyout",["ng"]).factory("flyoutPopover",[function(){return function(e,t,o,n){var r=n[0];angular.extend(e,{getActiveRow:r.getActiveRow,getSelector:r.getSelector})}}]).factory("flyoutLink",[function(){return function(e,t,o,n){var r=n[0];angular.extend(e,{mouseenterRow:r.mouseenterRow,clickRow:r.clickRow})}}]).factory("menuAim",[function(){function e(e,t,o){function r(e,t){return(t.y-e.y)/(t.x-e.x)}var l=1e3,i=null;if(!e)return 0;var u=t.offset(),c={x:u.left,y:u.top-o.tolerance},f={x:u.left+t.outerWidth(),y:c.y},a={x:u.left,y:u.top+t.outerHeight()+o.tolerance},s={x:u.left+t.outerWidth(),y:a.y},v=n[n.length-1],y=n[0];if(!v)return 0;if(y||(y=v),y.x<u.left||y.x>s.x||y.y<u.top||y.y>s.y)return 0;if(i&&v.x===i.x&&v.y===i.y)return 0;var m=f,p=s;"left"===o.submenuDirection?(m=a,p=c):"below"===o.submenuDirection?(m=s,p=a):"above"===o.submenuDirection&&(m=c,p=f);var g=r(v,m),d=r(v,p),w=r(y,m),R=r(y,p);return w>g&&d>R?(i=v,l):(i=null,0)}function t(e){n.push({x:e.pageX,y:e.pageY}),n.length>r&&n.shift()}function o(){return n}var n=[],r=3;return{activationDelay:e,setMouseLocs:t,getMouseLocs:o}}]).directive("flyoutItem",[function(){return{restrict:"E",transclude:!0,replace:!0,scope:!0,templateUrl:"template/flyout/flyout-item.html"}}]).directive("flyoutLink",["flyoutLink",function(e){return{restrict:"E",transclude:!0,replace:!0,require:["^flyoutNavigation"],scope:!0,templateUrl:"template/flyout/flyout-link.html",link:e}}]).directive("flyoutPopover",["flyoutPopover",function(e){return{restrict:"E",transclude:!0,replace:!0,require:["^flyoutNavigation"],scope:!0,templateUrl:"template/flyout/flyout-popover.html",link:e}}]).directive("flyoutNavigation",[function(){return{restrict:"E",scope:{visible:"=visible",selector:"@selector"},transclude:!0,replace:!0,templateUrl:"template/flyout/flyout.html",controllerAs:"flyoutCtrl",controller:"FlyoutController"}}]).controller("FlyoutController",["$element","$scope","menuAim",function(e,t,o){function n(){R=!0,p.find("."+t.selector).css("min-height",p.outerHeight())}function r(){d&&clearTimeout(d),u(),m.activeRow=null}function l(e){R||n(),d&&clearTimeout(d),a(e)}function i(e){R||n(),f(e)}function u(){t.visible=!1}function c(){t.visible=!0}function f(e){e!==m.activeRow&&(m.activeRow&&(m.activeRow=null),m.activeRow=e)}function a(e){var t=o.activationDelay(m.activeRow,g,w);t?d=setTimeout(function(){a(e)},t):f(e)}function s(){return m.activeRow}function v(){return t.selector}function y(){return t.visible||!1}t.selector=t.selector||"popover";var m=this,p=e,g=p.find(".flyout-dropdown");!function(){document.addEventListener("mousemove",o.setMouseLocs),angular.extend(m,{mouseleaveMenu:r,mouseenterRow:l,clickRow:i,closeMenu:u,openMenu:c,getActiveRow:s,getSelector:v,isVisible:y})}();var d=null,w={tolerance:500},R=!1}]);