"use strict";angular.module("neilff.flyout",["ng"]).factory("flyoutPopover",[function(){return function(e,t,n,o){var r=o[0];angular.extend(e,{getActiveRow:r.getActiveRow,getSelector:r.getSelector})}}]).factory("flyoutLink",[function(){return function(e,t,n,o){var r=o[0];angular.extend(e,{mouseenterRow:r.mouseenterRow,mouseleaveRow:r.mouseleaveRow,clickRow:r.clickRow})}}]).factory("menuAim",[function(){function e(e,t,n){function r(e,t){return(t.y-e.y)/(t.x-e.x)}var i=null;if(!e)return 0;var u=t.offset(),c={x:u.left,y:u.top-n.tolerance},l={x:u.left+t.outerWidth(),y:c.y},a={x:u.left,y:u.top+t.outerHeight()+n.tolerance},f={x:u.left+t.outerWidth(),y:a.y},s=o[o.length-1],v=o[0];if(!s)return 0;if(v||(v=s),v.x<u.left||v.x>f.x||v.y<u.top||v.y>f.y)return 0;if(i&&s.x===i.x&&s.y===i.y)return 0;var y=l,m=f;"left"===n.submenuDirection?(y=a,m=c):"below"===n.submenuDirection?(y=f,m=a):"above"===n.submenuDirection&&(y=c,m=l);var p=r(s,y),d=r(s,m),g=r(v,y),x=r(v,m);return g>p&&d>x?(i=s,n.delay):(i=null,0)}function t(e){o.push({x:e.pageX,y:e.pageY}),o.length>r&&o.shift()}function n(){return o}var o=[],r=3;return{activationDelay:e,setMouseLocs:t,getMouseLocs:n}}]).directive("flyoutItem",[function(){return{restrict:"E",transclude:!0,replace:!0,scope:!0,templateUrl:"template/flyout/flyout-item.html"}}]).directive("flyoutLink",["flyoutLink",function(e){return{restrict:"E",transclude:!0,replace:!0,require:["^flyoutNavigation"],scope:!0,templateUrl:"template/flyout/flyout-link.html",link:e}}]).directive("flyoutPopover",["flyoutPopover",function(e){return{restrict:"E",transclude:!0,replace:!0,require:["^flyoutNavigation"],scope:!0,templateUrl:"template/flyout/flyout-popover.html",link:e}}]).directive("flyoutNavigation",[function(){return{restrict:"E",scope:{visible:"=",tolerance:"=",delay:"=",direction:"=",enter:"=",exit:"=",activate:"=",deactivate:"=",exitmenu:"=exitmenu",selector:"@"},transclude:!0,replace:!0,templateUrl:"template/flyout/flyout.html",controllerAs:"flyoutCtrl",controller:"FlyoutController"}}]).controller("FlyoutController",["$element","$scope","menuAim",function(e,t,n){function o(){E=!0,L.find("."+t.selector).css("min-height",L.outerHeight())}function r(){D&&clearTimeout(D),M.exitmenu(this)&&(k.activeRow&&M.deactivate(k.activeRow),k.activeRow=null)}function i(e){D&&clearTimeout(D),M.enter(e),s(e)}function u(e){M.exit(e)}function c(e){f(e)}function l(){t.visible=!1}function a(){t.visible=!0}function f(e){e!==k.activeRow&&(k.activeRow&&M.deactivate(k.activeRow),M.activate(e),k.activeRow=e)}function s(e){var t=n.activationDelay(k.activeRow,A,M);t?D=setTimeout(function(){s(e)},t):f(e)}function v(){return k.activeRow}function y(){return t.selector}function m(){return t.delay||1e3}function p(){return t.tolerance||500}function d(){return t.direction||"right"}function g(){return t.enter||function(){E||o()}}function x(){return t.exit||angular.noop}function w(){return t.activate||function(){E||o()}}function R(){return t.exitmenu||function(){return l(),!0}}function h(){return t.deactivate||angular.noop}function b(){return t.visible||!1}t.selector=t.selector||"popover";var k=this,L=e,A=L.find(".flyout-dropdown");!function(){document.addEventListener("mousemove",n.setMouseLocs),angular.extend(k,{mouseleaveMenu:r,mouseenterRow:i,mouseleaveRow:u,clickRow:c,closeMenu:l,openMenu:a,getActiveRow:v,getSelector:y,isVisible:b})}();var D=null,M={submenuDirection:d(),tolerance:p(),delay:m(),enter:g(),exit:x(),activate:w(),deactivate:h(),exitmenu:R()},E=!1}]);